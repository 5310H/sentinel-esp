<!DOCTYPE html>
<html>
<head>
    <title>Sentinel Control Panel</title>
    <style>
        body { font-family: sans-serif; background: #121212; color: #e0e0e0; padding: 20px; }
        .card { background: #1e1e1e; padding: 25px; border-radius: 12px; margin-bottom: 20px; border: 1px solid #333; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px; }
        .item { background: #252525; padding: 15px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; border-left: 6px solid #444; transition: 0.3s; }
        .violated { border-left-color: #ff5252; background: #331a1a; }
        .on { border-left-color: #4caf50; background: #1a331a; }
        .state-text { font-size: 28px; font-weight: bold; margin-bottom: 15px; letter-spacing: 1px; }
        .ARMED { color: #ff5252; text-shadow: 0 0 10px rgba(255,82,82,0.3); }
        .DISARMED { color: #4caf50; text-shadow: 0 0 10px rgba(76,175,80,0.3); }
        button { cursor: pointer; padding: 8px 16px; background: #333; color: white; border: 1px solid #444; border-radius: 6px; font-size: 13px; text-transform: uppercase; }
        button:hover { background: #444; }
        h3 { color: #888; text-transform: uppercase; font-size: 14px; margin-top: 30px; letter-spacing: 2px; }
    </style>
</head>
<body>

    <div class="card">
        <div id="st" class="state-text">INITIALIZING...</div>
        <button onclick="fetch('/api/arm')">Set Away (ARM)</button>
        <button onclick="fetch('/api/disarm')" style="margin-left:10px;">Stand Down (DISARM)</button>
    </div>

    <h3>Zones</h3>
    <div id="zGrid" class="grid"></div>

    <h3>Active Outputs</h3>
    <div id="rGrid" class="grid"></div>

    <script>
        function update() {
            fetch('/api/config').then(r => r.json()).then(data => {
                document.getElementById('st').innerText = data.state;
                document.getElementById('st').className = 'state-text ' + data.state;

                // Render Zones
                document.getElementById('zGrid').innerHTML = data.zones.map(z => `
                    <div class="item ${z.violated ? 'violated' : ''}">
                        <div><b>${z.name}</b><br><small>${z.type}</small></div>
                        <button onclick="fetch('/api/trigger?id=${z.id}')">Trip</button>
                    </div>
                `).join('');

                // Render Relays
                document.getElementById('rGrid').innerHTML = data.relays.map(r => `
                    <div class="item ${r.state ? 'on' : ''}">
                        <div><b>${r.Name}</b><br><small>Hardware ID: ${r.ID}</small></div>
                        <span>${r.state ? '● ACTIVE' : '○ IDLE'}</span>
                    </div>
                `).join('');
            }).catch(e => { document.getElementById('st').innerText = "OFFLINE"; });
        }
        setInterval(update, 1000);
        update();
    </script>
</body>
</html>